# 更新日志

本文档记录所有版本的更新历史，包括新功能、Bug修复和重要变更。

---

## v1.3.3 (2025-11-02)

### 修复
- 搜索结果显示优化：统一显示格式，移除多余信息，紧密排列结果
- 修复 Markdown 格式显示问题，文字本身作为超链接

---

## v1.3.2 (2025-11-02)

### 修复
- **Markdown 解析错误**：修复搜索结果中包含特殊字符导致的解析失败
- **搜索无结果问题**：修复频道元信息未索引到 messages 表的问题

---

## v1.3.1 (2025-11-02)

### 安全改进
- 新增存储频道发送延迟配置，避免触发 Flood Control
- 添加 `STORAGE_SEND_DELAY` 和 `STORAGE_SEND_RANDOM_DELAY` 配置项

---

## v1.3.0 (2025-11-02)

### 新功能
- **频道元信息存储**：频道元信息也作为搜索数据存储到 SearchDataStore 频道
- 使用 `#频道元信息` 标签区分频道元信息和消息内容
- 支持搜索频道名称、分类等元信息

详见：[FEATURES.md](docs/features/FEATURES.md)

---

## v1.2.2 (2025-11-02)

### 改进
- 可配置的频道验证延迟时间
- 新增 `CHANNEL_VERIFY_DELAY` 和 `CHANNEL_VERIFY_RANDOM_DELAY` 配置项

---

## v1.2.1 (2025-11-02)

### 修复
- **智能频道验证**：只保存真实存在的频道，跳过 Bot 和已存在的频道
- 添加数据库检查，避免重复请求
- 优化错误处理，区分频道不存在和速率限制

---

## v1.2.0 (2025-11-02)

### 新功能
- **自动获取频道信息**：使用 Telegram Bot API 获取频道名称、ID、成员数等
- **MessageEntity 链接提取**：支持提取转发消息中隐藏在文字中的链接（TEXT_LINK 类型）

### 修复
- 修复 MessageEntity 链接提取问题
- 改进频道验证流程

---

## v1.1.1 (2025-11-02)

### 修复
- **频道消息处理错误**：修复 `'NoneType' object has no attribute 'text'` 错误
- 正确处理频道消息类型（`channel_post`）和普通消息（`message`）

---

## v1.1.0 (2025-11-02)

### 新功能
- **群组自动搜索**：Bot 加入搜索群组后，用户直接输入关键词即可搜索
- **优化的搜索结果显示**：结果带超链接、简洁显示、视频显示时长
- **顶部广告位**：支持自定义搜索结果顶部广告
- **类型分类按钮**：支持按类型筛选（全部、视频、图片、文档）
- **改进的翻页功能**：支持按类型翻页

### 配置变更
- 新增 `SEARCH_GROUP_ID` 配置
- 新增 `STORAGE_CHANNEL_ID` 配置
- 新增 `SEARCH_AD_TEXT` 和 `SEARCH_AD_ENABLED` 配置
- 新增 `RESULTS_PER_PAGE` 配置

---

## 未来计划

### v1.4.0（规划中）
- [ ] 24小时滚动窗口速率限制
- [ ] 分批处理机制
- [ ] 从文本文件批量导入频道

### v1.5.0（规划中）
- [ ] 视频时长自动提取和存储
- [ ] 搜索历史记录
- [ ] 热门搜索关键词统计
- [ ] 搜索结果缓存

